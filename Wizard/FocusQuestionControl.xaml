<UserControl 
    x:Class="Gymplanner.Wizard.FocusQuestionControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:vm="clr-namespace:Gymplanner.Wizard"
    Height="Auto" Width="Auto">

    <UserControl.Resources>
        <vm:ListContainsConverter x:Key="ListContainsConverter"/>
    </UserControl.Resources>

    <StackPanel Margin="16" VerticalAlignment="Top">

        <!-- Title -->
        <TextBlock 
        Text="Which area do you want to focus on?" 
        FontSize="18" FontWeight="Bold" 
        Margin="0,0,0,12"/>

        <!-- Broad-area buttons -->
        <StackPanel Orientation="Horizontal" Margin="0,8">
            <Button Content="Upper Body"
              Command="{Binding SelectFocusCommand}"
              CommandParameter="Upper body"
              Margin="0,5"/>
            <Button Content="Lower Body"
              Command="{Binding SelectFocusCommand}"
              CommandParameter="Lower body"
              Margin="0,5"/>
            <Button Content="Full Body"
              Command="{Binding SelectFocusCommand}"
              CommandParameter="Full body"
              Margin="0,5"/>
        </StackPanel>

        <!-- Expander for specific muscles -->
        <Expander Header="…or pick specific muscles" Margin="0,16,0,0">
            <StackPanel>

                <!-- Insert the CheckBox binding example here inside the ItemsControl -->
                <ItemsControl ItemsSource="{Binding AllMuscleOptions}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <CheckBox Content="{Binding}">
                                <CheckBox.IsChecked>
                                    <MultiBinding 
                                      Converter="{StaticResource ListContainsConverter}"
                                      Mode="OneWay">
                                        <!-- ← ensure it’s NOT TwoWay -->
                                        <Binding 
        Path="DataContext.SelectedMuscles"
        RelativeSource="{RelativeSource AncestorType=UserControl}"/>
                                        <Binding/>
                                        <!-- this is your muscle name -->
                                    </MultiBinding>
                                </CheckBox.IsChecked>
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="Click">
                                        <i:InvokeCommandAction 
                                            Command="{Binding DataContext.ToggleMuscleCommand,
                                                      RelativeSource={RelativeSource AncestorType=UserControl}}"
                                            CommandParameter="{Binding}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </CheckBox>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>


                <Button Content="Done"
                Command="{Binding CommitMuscleSelectionCommand}"
                Margin="0,8,0,0"
                HorizontalAlignment="Right"/>
            </StackPanel>
        </Expander>

    </StackPanel>
</UserControl>

